# æ•™ç»ƒæ”¶ç›Šç»Ÿè®¡åŠŸèƒ½ - ä½¿ç”¨è¯´æ˜Ž

## ðŸ“‹ åŠŸèƒ½æ¦‚è¿°

æœ¬åŠŸèƒ½å…è®¸è¶…çº§ç®¡ç†å‘˜æŸ¥çœ‹æŒ‡å®šæ•™ç»ƒåœ¨æŒ‡å®šæ—¶é—´æ®µå†…çš„æ‰€æœ‰è¯¾ç¨‹ã€é¢„è®¢æƒ…å†µå’Œæ”¶ç›Šç»Ÿè®¡ã€‚

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

1. **æŒ‰æ•™ç»ƒæŸ¥è¯¢**: é€‰æ‹©ç‰¹å®šæ•™ç»ƒæŸ¥çœ‹å…¶æ”¶ç›Šç»Ÿè®¡
2. **æ—¶é—´èŒƒå›´ç­›é€‰**: æ”¯æŒæŒ‰å¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸç­›é€‰
3. **è¯¦ç»†ç»Ÿè®¡**: æ˜¾ç¤ºæ¯ä¸ªè¯¾ç¨‹çš„è¯¦ç»†ä¿¡æ¯ã€é¢„è®¢æ•°é‡å’Œæ”¶ç›Š
4. **æ±‡æ€»æ•°æ®**: è‡ªåŠ¨è®¡ç®—è¯¾ç¨‹æ€»æ•°ã€æ€»é¢„è®¢æ•°å’Œæ€»æ”¶ç›Š

## ðŸ“Š æ•°æ®ç»Ÿè®¡é€»è¾‘

### æ”¶ç›Šè®¡ç®—æ–¹å¼

```
è¯¾ç¨‹æ”¶ç›Š = è¯¾ç¨‹è´¹ç”¨ Ã— é¢„è®¢æ•°é‡
æ€»æ”¶ç›Š = æ‰€æœ‰è¯¾ç¨‹æ”¶ç›Šä¹‹å’Œ
```

### ç»Ÿè®¡èŒƒå›´

- **åŒ…å«çš„è®¢å•**: åªç»Ÿè®¡ `payment_status = '1'`ï¼ˆå·²æ”¯ä»˜ï¼‰çš„è®¢å•
- **é€€æ¬¾è®¢å•**: ä¸è®¡å…¥æ”¶ç›Šç»Ÿè®¡ï¼ˆé€€æ¬¾åŽ payment_status = '2'ï¼‰
- **æœªæ”¯ä»˜è®¢å•**: ä¸è®¡å…¥æ”¶ç›Šç»Ÿè®¡

## ðŸš€ ä½¿ç”¨æ–¹æ³•

### è®¿é—®è·¯å¾„

- **URL**: `/order/coach/revenue`
- **è·¯ç”±**: `/order/coach/revenue`
- **æƒé™**: éœ€è¦ç™»å½•ç®¡ç†å‘˜è´¦å·

### æ“ä½œæ­¥éª¤

1. **ç™»å½•ç³»ç»Ÿ**
   - ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•ï¼ˆuserType = '1'ï¼‰

2. **è¿›å…¥é¡µé¢**
   - åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ `/order/coach/revenue`
   - æˆ–åœ¨ç®¡ç†ç«¯èœå•ä¸­ç‚¹å‡»"æ•™ç»ƒæ”¶ç›Šç»Ÿè®¡"

3. **é€‰æ‹©æ•™ç»ƒ**
   - åœ¨"é€‰æ‹©æ•™ç»ƒ"ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©è¦æŸ¥è¯¢çš„æ•™ç»ƒ
   - æ”¯æŒæœç´¢æ•™ç»ƒå§“åå¿«é€Ÿå®šä½

4. **è®¾ç½®æ—¶é—´èŒƒå›´ï¼ˆå¯é€‰ï¼‰**
   - é€‰æ‹©"å¼€å§‹æ—¥æœŸ"å’Œ"ç»“æŸæ—¥æœŸ"
   - ä¸è®¾ç½®æ—¶é—´èŒƒå›´åˆ™æŸ¥è¯¢æ‰€æœ‰åŽ†å²æ•°æ®

5. **ç‚¹å‡»"æŸ¥è¯¢"æŒ‰é’®**
   - ç³»ç»Ÿæ˜¾ç¤ºè¯¥æ•™ç»ƒçš„æ”¶ç›Šç»Ÿè®¡åˆ—è¡¨
   - é¡¶éƒ¨æ˜¾ç¤ºæ±‡æ€»æ•°æ®

## ðŸ“± é¡µé¢åŠŸèƒ½è¯´æ˜Ž

### ç­›é€‰åŒºåŸŸ

| å­—æ®µ | è¯´æ˜Ž | å¿…å¡« |
|------|------|------|
| é€‰æ‹©æ•™ç»ƒ | ä»Žä¸‹æ‹‰æ¡†é€‰æ‹©æ•™ç»ƒ | âœ… æ˜¯ |
| å¼€å§‹æ—¥æœŸ | è¯¾ç¨‹å¼€å§‹æ—¥æœŸçš„èµ·å§‹èŒƒå›´ | âŒ å¦ |
| ç»“æŸæ—¥æœŸ | è¯¾ç¨‹å¼€å§‹æ—¥æœŸçš„ç»“æŸèŒƒå›´ | âŒ å¦ |

### ç»Ÿè®¡æ‘˜è¦

- **è¯¾ç¨‹æ€»æ•°**: è¯¥æ•™ç»ƒåœ¨æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„è¯¾ç¨‹æ•°é‡
- **æ€»é¢„è®¢æ•°**: æ‰€æœ‰è¯¾ç¨‹çš„æ€»é¢„è®¢äººæ¬¡
- **æ€»æ”¶ç›Š**: æ‰€æœ‰å·²æ”¯ä»˜è®¢å•çš„é‡‘é¢æ€»å’Œ

### æ”¶ç›Šæ˜Žç»†è¡¨æ ¼

| åˆ—å | è¯´æ˜Ž |
|------|------|
| è¯¾ç¨‹ID | è¯¾ç¨‹çš„å”¯ä¸€æ ‡è¯† |
| è¯¾ç¨‹åç§° | è¯¾ç¨‹çš„å…·ä½“åç§° |
| è¯¾ç¨‹è´¹ç”¨ | å•èŠ‚è¯¾ç¨‹çš„ä»·æ ¼ |
| å¼€å§‹æ—¶é—´ | è¯¾ç¨‹çš„å¼€å§‹æ—¶é—´ |
| ç»“æŸæ—¶é—´ | è¯¾ç¨‹çš„ç»“æŸæ—¶é—´ |
| é¢„è®¢æ•°é‡ | è¯¥è¯¾ç¨‹çš„é¢„è®¢äººæ•° |
| è¯¾ç¨‹æ”¶ç›Š | è¯¥è¯¾ç¨‹çš„æ”¶ç›Šé‡‘é¢ï¼ˆè´¹ç”¨Ã—äººæ•°ï¼‰ |

## ðŸ”§ æŠ€æœ¯å®žçŽ°

### åŽç«¯æŽ¥å£

#### 1. æŸ¥è¯¢æ•™ç»ƒæ”¶ç›Šåˆ—è¡¨
```
GET /order/coach/revenue
```

**è¯·æ±‚å‚æ•°**:
- `coachId` (å¿…å¡«): æ•™ç»ƒID
- `startDate` (å¯é€‰): å¼€å§‹æ—¥æœŸï¼Œæ ¼å¼: YYYY-MM-DD
- `endDate` (å¯é€‰): ç»“æŸæ—¥æœŸï¼Œæ ¼å¼: YYYY-MM-DD

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 1,
  "msg": "success",
  "data": [
    {
      "courseId": 101,
      "courseName": "ç‘œä¼½åŸºç¡€",
      "scheduleStart": "2026-02-01T10:00:00",
      "scheduleEnd": "2026-02-01T11:30:00",
      "courseFee": 50.00,
      "bookingCount": 5,
      "totalRevenue": 250.00
    }
  ]
}
```

#### 2. æŸ¥è¯¢æ•™ç»ƒæ€»æ”¶ç›Š
```
GET /order/coach/totalRevenue
```

**è¯·æ±‚å‚æ•°**: åŒä¸Š

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 1,
  "msg": "success",
  "data": 250.00
}
```

### æ•°æ®åº“æŸ¥è¯¢

**SQLé€»è¾‘**:
```sql
SELECT
    c.course_id AS courseId,
    c.course_name AS courseName,
    c.schedule_start AS scheduleStart,
    c.schedule_end AS scheduleEnd,
    c.course_fee AS courseFee,
    COUNT(DISTINCT b.booking_id) AS bookingCount,
    SUM(p.amount) AS totalRevenue
FROM gym_courses c
    LEFT JOIN gym_coachs co ON c.coach_id = co.coach_id
    LEFT JOIN gym_booking b ON c.course_id = b.course_id
    LEFT JOIN gym_payments p ON b.booking_id = p.booking_id
    AND p.payment_status = '1'
WHERE co.coach_id = #{coachId}
    AND DATE(c.schedule_start) >= #{startDate}
    AND DATE(c.schedule_start) <= #{endDate}
GROUP BY c.course_id, c.course_name, c.schedule_start, c.schedule_end, c.course_fee
ORDER BY c.schedule_start DESC
```

## ðŸ’¡ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: æœˆåº¦æ•™ç»ƒç»©æ•ˆè¯„ä¼°
- æ“ä½œï¼šé€‰æ‹©æ•™ç»ƒï¼Œè®¾ç½®å½“æœˆ1æ—¥åˆ°æœˆæœ«ä¸ºæ—¶é—´èŒƒå›´
- ç”¨é€”ï¼šè¯„ä¼°æ•™ç»ƒçš„æœˆåº¦ä¸šç»©å’Œæ”¶ç›Šè´¡çŒ®

### åœºæ™¯2: å­£åº¦æ”¶ç›Šç»Ÿè®¡
- æ“ä½œï¼šé€‰æ‹©æ•™ç»ƒï¼Œè®¾ç½®å­£åº¦èµ·æ­¢æ—¥æœŸ
- ç”¨é€”ï¼šåˆ†æžå­£åº¦å†…çš„ä¸šåŠ¡è¡¨çŽ°å’Œæ”¶å…¥å˜åŒ–

### åœºæ™¯3: å¹´åº¦æ€»æ”¶ç›ŠæŸ¥è¯¢
- æ“ä½œï¼šé€‰æ‹©æ•™ç»ƒï¼Œä¸è®¾ç½®æ—¶é—´èŒƒå›´ï¼ˆæˆ–è®¾ç½®å…¨å¹´ï¼‰
- ç”¨é€”ï¼šç»Ÿè®¡å¹´åº¦æ€»æ”¶ç›Šï¼Œç”¨äºŽå¹´ç»ˆæ€»ç»“å’Œå¥–é‡‘è®¡ç®—

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ—¶é—´èŒƒå›´**: è¯¾ç¨‹æ—¶é—´æŒ‡çš„æ˜¯ `schedule_start`ï¼Œå³è¯¾ç¨‹å¼€å§‹æ—¶é—´
2. **é€€æ¬¾å¤„ç†**: é€€æ¬¾çš„è®¢å•ä¸è®¡å…¥æ”¶ç›Šç»Ÿè®¡
3. **æœªæ”¯ä»˜è®¢å•**: æ”¯ä»˜çŠ¶æ€ä¸º"æœªæ”¯ä»˜"çš„è®¢å•ä¸è®¡å…¥ç»Ÿè®¡
4. **æ•°æ®å®žæ—¶æ€§**: æ”¶ç›Šæ•°æ®å®žæ—¶è®¡ç®—ï¼ŒåŸºäºŽå½“å‰æ•°æ®åº“çŠ¶æ€

## ðŸ” æ•°æ®å…³ç³»

```
gym_coachs (æ•™ç»ƒè¡¨)
    â†“ coach_id
gym_courses (è¯¾ç¨‹è¡¨)
    â†“ course_id
gym_booking (é¢„è®¢è¡¨)
    â†“ booking_id
gym_payments (æ”¯ä»˜è¡¨) [ä»… payment_status = '1']
```

## ðŸ“ æ›´æ–°æ—¥å¿—

- **2026-02-10**: åˆ›å»ºæ•™ç»ƒæ”¶ç›Šç»Ÿè®¡åŠŸèƒ½
  - æ”¯æŒæŒ‰æ•™ç»ƒå’Œæ—¶é—´èŒƒå›´æŸ¥è¯¢
  - æä¾›è¯¦ç»†çš„è¯¾ç¨‹æ”¶ç›Šæ˜Žç»†
  - è‡ªåŠ¨è®¡ç®—æ±‡æ€»ç»Ÿè®¡æ•°æ®

## ðŸ†˜ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæŸäº›è¯¾ç¨‹æ²¡æœ‰æ˜¾ç¤ºæ”¶ç›Šæ•°æ®ï¼Ÿ
A: å¯èƒ½æœ‰ä»¥ä¸‹åŽŸå› ï¼š
- è¯¥è¯¾ç¨‹æ²¡æœ‰å·²æ”¯ä»˜çš„é¢„è®¢è®°å½•
- è¯¾ç¨‹çš„æ—¶é—´ä¸åœ¨æŒ‡å®šçš„æ—¶é—´èŒƒå›´å†…

### Q2: é€€æ¬¾åŽçš„è¯¾ç¨‹å¦‚ä½•è®¡ç®—æ”¶ç›Šï¼Ÿ
A: é€€æ¬¾åŽçš„è®¢å• `payment_status` å˜ä¸º '2'ï¼Œä¸è®¡å…¥æ”¶ç›Šç»Ÿè®¡

### Q3: èƒ½å¦åŒæ—¶æŸ¥è¯¢å¤šä¸ªæ•™ç»ƒçš„æ”¶ç›Šï¼Ÿ
A: å½“å‰ç‰ˆæœ¬ä¸æ”¯æŒï¼Œä¸€æ¬¡åªèƒ½æŸ¥è¯¢ä¸€ä¸ªæ•™ç»ƒçš„æ”¶ç›Šã€‚å»ºè®®åˆ†åˆ«æŸ¥è¯¢åŽæ‰‹åŠ¨æ±‡æ€»ã€‚

### Q4: å¦‚ä½•æŒ‰æœˆä»½å¿«é€ŸæŸ¥çœ‹æ”¶ç›Šï¼Ÿ
A: è®¾ç½®å¼€å§‹æ—¥æœŸä¸ºæœˆåˆï¼ˆå¦‚2026-02-01ï¼‰ï¼Œç»“æŸæ—¥æœŸä¸ºæœˆæœ«ï¼ˆå¦‚2026-02-28ï¼‰

---

**å¼€å‘è€…**: æ²ˆä½³æ ‹
**æœ€åŽæ›´æ–°**: 2026-02-10
**ç‰ˆæœ¬**: 1.0.0
